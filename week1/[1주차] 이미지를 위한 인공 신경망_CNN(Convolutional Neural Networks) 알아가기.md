1주차 : 사물인식을 다루기 위해 'CNN을 활용한 영상 기반의 화재 감지' 논문과 '혼자 공부하는 머신러닝+딥러닝'을 읽고 정리하며 **이미지를 위한 인공 신경망**인 **CNN**에 대한 개념을 공부하는 시간을 가졌습니다.

## 1. 딥러닝

여러 비선형 변환 기법을 이용해서 학습 데이터에 대한 높은 수준의 추상화를 통해 데이터의 주요 특징들을 추출한 다음, 데이터 군집 및 분류를 수행하는 기계학습의 일종이다. 

## 2. CNN (**Convolutional Neural Networks**)

CNN은 이미지 인식이나 영상 데이터를 처리할 때 주로 사용되는 신경망의 한 종류로, 전처리 작업 Convolution이 들어가는 Neural Network 모델이다. 

**합성곱 층**에서 입력의 크기를 유지하며 각 필터가 추출한 특성 맵을 출력하면, **풀링 층**에서 특성 맵의 가로세로를 줄인다. (일반적으로 최대 풀링을 즐겨 사용하며 특성 맵을 절반으로 줄인다.) 마지막에는 특성 맵을 1차원 배열로 펼쳐서 1개 이상의 밀집층에 통과시켜 클래스에 대한 확률을 만든다. 

이미지 인식 관련 분야에서 딥러닝을 활용한 기법은 대부분 CNN을 기초로 한다. 

## 3. Convolution(합성곱) 동작 원리

입력 데이터에 유용한 특성만 드러나도록 하는 것으로 필터(커널)가 입력 위를 이동하면서 출력을 만든다. 
![합성곱](https://user-images.githubusercontent.com/70934572/141668555-0793a1da-9f11-4e6e-9322-d6966d31e2dc.png)
하나의 채널에 대한 합성곱 계층의 동작 (그림 출처 : [https://untitledtblog.tistory.com/150](https://untitledtblog.tistory.com/150))

- 인공신경망 모델 훈련법
    1. 처음에 가중치 W1 ~ Wn과 절편 b를 랜덤하게 초기화
    2. 에포크를 반복하면서 하강법 알고리즘을 사용하여, 손실이 낮아지도록 최적의 가중치와 절편 찾기

- 에포크(epoch) : 학습의 횟수
- 배치(batch) : 모델의 가중치를 한번 업데이트시킬 때 사용되는 샘플들의 묶음
- 에포크와 배치
    - 총 훈련 샘플 수 : 1000개, 배치 사이즈 : 20
        
        20개의 샘플 단위마다 모델의 가중치를 한번씩 업데이트하여 가중치가 총 50번 업데이트 (하나의 데이터셋을 총 50개의 배치로 나누어 훈련 진행)
        
    - 총 훈련 샘플 수 : 1000개, 에포크 : 10, 배치 사이즈 : 20
        
        위에서의 가중치를 50번 업데이트 하는 것을 총 10번 반복, 각 데이터 샘플이 총 10번씩 사용되므로 결과적으로 가중치가 총 500번 업데이트
        

## 4. CNN의 전체 구조
![전체 CNN 구조](https://user-images.githubusercontent.com/70934572/141668564-8e99494f-2343-44bc-87f0-3f92fb209089.png)
(그림 출처 :  [https://neocarus.tistory.com/entry/CNN의-구조](https://neocarus.tistory.com/entry/CNN%EC%9D%98-%EA%B5%AC%EC%A1%B0))

합성곱 층과 풀링 층이 번갈아가면서 수행함으로써 학습 이미지나 영상으로부터 인식 대상의 특징을 자동으로 추출한다.

- 합성곱 층은 이전 계층으로부터 들어오는 입력 데이터에 학습된 커널을 한 칸씩 움직이면서 컨볼루션 연산을 수행하여 이미지의 특성을 고려하며 특징을 추출할 수 있다.
- 풀링 층은 합성곱 층을 통해 생성된 특징 맵 (feature map)의 차원 수를 줄여주는 역할을 한다.
    
    이때 최대 풀링(max pooling)과 평균 풀링(average pooling) 등의 방법이 있는데 일반적으로 영상 내 더 자극적인 정보를 특징으로 취득하기 위해 최대 풀링을 많이 사용한다.
    

합성곱 층과 풀링 층이 번갈아가며 여러 차례 수행되고 나면 주요 패턴 정보를 가진 특징들이 자동으로 추출되어 이를 바탕으로 풀링 층에서 최종적으로 이미지나 영상의 인식 결과를 출력하게 된다.
